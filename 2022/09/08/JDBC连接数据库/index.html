<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.2.0">

<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <link rel="manifest" href="/manifest.json">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic%7CLobster+Two:300,300italic,400,400italic,700,700italic%7CAmita:300,300italic,400,400italic,700,700italic%7CMontserrat:300,300italic,400,400italic,700,700italic%7CPT+Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"airui520.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":"true`","version":"8.12.1","exturl":false,"sidebar":{"position":"left","width":300,"display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="blog">
<meta property="og:title" content="JDBC连接数据库">
<meta property="og:url" content="https://airui520.github.io/2022/09/08/JDBC%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93/index.html">
<meta property="og:site_name" content="Fei的博客">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://files.catbox.moe/vakrmb.png">
<meta property="og:image" content="https://files.catbox.moe/0j9zo2.png">
<meta property="og:image" content="https://files.catbox.moe/lv8m1j.png">
<meta property="og:image" content="https://files.catbox.moe/tqdw0i.png">
<meta property="og:image" content="https://files.catbox.moe/bb73ur.png">
<meta property="og:image" content="https://files.catbox.moe/j2v6oe.png">
<meta property="article:published_time" content="2022-09-08T10:51:35.000Z">
<meta property="article:modified_time" content="2022-09-09T07:03:25.868Z">
<meta property="article:author" content="Fei">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://files.catbox.moe/vakrmb.png">


<link rel="canonical" href="https://airui520.github.io/2022/09/08/JDBC%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://airui520.github.io/2022/09/08/JDBC%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93/","path":"2022/09/08/JDBC连接数据库/","title":"JDBC连接数据库"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>JDBC连接数据库 | Fei的博客</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXXX-X"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-XXXXXXXX-X","only_pageview":false}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Fei的博客</p>
      <i class="logo-line"></i>
    </a>
      <img class="custom-logo-image" src="/images/bg.jpg" alt="Fei的博客">
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">65</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#JDBC"><span class="nav-number">1.</span> <span class="nav-text">JDBC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#JDBC%E7%AE%80%E4%BB%8B"><span class="nav-number">1.1.</span> <span class="nav-text">JDBC简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JDBC%E5%B8%B8%E7%94%A8%E6%8E%A5%E5%8F%A3%E5%92%8C%E7%B1%BB"><span class="nav-number">1.2.</span> <span class="nav-text">JDBC常用接口和类</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#DriverManager%E7%B1%BB"><span class="nav-number">1.2.1.</span> <span class="nav-text">DriverManager类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Connection%E6%8E%A5%E5%8F%A3"><span class="nav-number">1.2.2.</span> <span class="nav-text">Connection接口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Statement%E6%8E%A5%E5%8F%A3"><span class="nav-number">1.2.3.</span> <span class="nav-text">Statement接口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ResultSet%E6%8E%A5%E5%8F%A3"><span class="nav-number">1.2.4.</span> <span class="nav-text">ResultSet接口</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JDBC%E7%BC%96%E7%A8%8B%E6%AD%A5%E9%AA%A4"><span class="nav-number">1.3.</span> <span class="nav-text">JDBC编程步骤</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8PrepareStatement%E6%89%A7%E8%A1%8CSQL%E8%AF%AD%E5%8F%A5"><span class="nav-number">1.4.</span> <span class="nav-text">使用PrepareStatement执行SQL语句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%AF%E6%BB%9A%E5%8A%A8%E7%9A%84%E7%BB%93%E6%9E%9C%E9%9B%86"><span class="nav-number">1.5.</span> <span class="nav-text">可滚动的结果集</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8ResultSetMetaData%E5%88%86%E6%9E%90%E7%BB%93%E6%9E%9C%E9%9B%86"><span class="nav-number">1.6.</span> <span class="nav-text">使用ResultSetMetaData分析结果集</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Fei"
      src="/images/head.jpg">
  <p class="site-author-name" itemprop="name">Fei</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">65</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/AiRui520" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;AiRui520" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:2813764348@qq.com" title="E-Mail → mailto:2813764348@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
  </div>


  <div class="links-of-blogroll site-overview-item animated">
    <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://xiguayaaaaa.github.io/" title="https:&#x2F;&#x2F;xiguayaaaaa.github.io" rel="noopener" target="_blank">xigua</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://simon-yian.com/" title="https:&#x2F;&#x2F;simon-yian.com" rel="noopener" target="_blank">banana</a>
        </li>
    </ul>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/AiRui520" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://airui520.github.io/2022/09/08/JDBC%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.jpg">
      <meta itemprop="name" content="Fei">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fei的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="JDBC连接数据库 | Fei的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          JDBC连接数据库<a href="https://github.com/AiRui520/next/edit/main/subdirectory-name/_posts/JDBC%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93.md" class="post-edit-link" title="编辑" rel="noopener" target="_blank"><i class="fa fa-pen-nib"></i></a>
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-08 18:51:35" itemprop="dateCreated datePublished" datetime="2022-09-08T18:51:35+08:00">2022-09-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-09-09 15:03:25" itemprop="dateModified" datetime="2022-09-09T15:03:25+08:00">2022-09-09</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>14k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>13 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p><img src="https://files.catbox.moe/vakrmb.png"></p>
<span id="more"></span>

<h1 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h1><p>在前面的学习，通过CMD命令窗口或者图形界面工具连接并使用MySQL数据库，在一款软件的开发过程中，我们一般使用命令窗口或者图形界面工具调试或者测试数据，用不同的语言去连接数据库，进行数据操作，以Java为例，Java为我们提供并封装了一系列操作数据库的接口（这里的数据库不单单指MySQL，也包括其他关系型数据库例如:SqlServer或者oracle等）。在本章节内，我们将详细学习如果使用。</p>
<h2 id="JDBC简介"><a href="#JDBC简介" class="headerlink" title="JDBC简介"></a>JDBC简介</h2><p>JDBC 的全称是 Java Database Connectivity，即 Java 数据库连接，它是一种可以执行 SQL 语句的 Java API。程序可通过 JDBC API 连接到关系数据库，并使用结构化查询语言（SOL，数据库标准的查询语言）来完成对数据库的查询、更新。 与其他数据库编程环境相比，JDBC 为数据库开发提供了标准的 API，所以使用 JDBC 开发的数据库应用可以跨平台运行，而且可以跨数据库（如果全部使用标准的 SQL）。也就是说，如果使用 JDBC开发一个数据库应用，则该应用既可以在 Windows 平台上运行，也可以在 UNIX 等其他平台上运行;既可以使用 MySQL 数据库，也可以使用 Oracle 等数据库，而程序无须进行任何修改。</p>
<p>Java 语言的各种跨平台特性，都采用相似的结构，因为它们都需要让相同的程序在不同的平台上运行，所以都需要中间的转换程序（为了实现 Java 程序的跨平台性，Java为不同的操作系统提供了不同的虚拟机）。同样，为了使JDBC程序可以跨平台，则需要不同的数据库厂商提供相应的驱动程序。</p>
<p><img src="https://files.catbox.moe/0j9zo2.png"></p>
<p>上图显示了JDBC驱动示意图。 正是通过 JDBC驱动的转换，才使得使用相同 JDBC API 编写的程序，在不同的数据库系统上运行良好。</p>
<p>Sun 提供的 JDBC 可以完成以下三个基本工作。  </p>
<ol>
<li>建立与数据库的连接</li>
<li>执行SQL语句</li>
<li>获取SQL语句的执行结果</li>
</ol>
<h2 id="JDBC常用接口和类"><a href="#JDBC常用接口和类" class="headerlink" title="JDBC常用接口和类"></a>JDBC常用接口和类</h2><p>学习JDBC之前需要先了解常用的接口和类，了解完这些接口和类以后就可以使用JDBC连接并操作数据库。</p>
<h3 id="DriverManager类"><a href="#DriverManager类" class="headerlink" title="DriverManager类"></a>DriverManager类</h3><p>该接口用于管理JDBC驱动的服务类，该类的主要作用是获取Java与数据库连接的Connection对象，Connection对象可以想象成Java与数据库通信的桥梁。DriverManager的主要方法如下：</p>
<ul>
<li>public static Connection getConnection(String url,String user, String password) throws SQLException：该方法用于获取url对应的数据库连接，user指数据库的用户名，password指数据库的用户密码</li>
</ul>
<h3 id="Connection接口"><a href="#Connection接口" class="headerlink" title="Connection接口"></a>Connection接口</h3><p>该接口代表数据库的连接对象，每个Connection代表一个物理连接会话，要想访问数据库，必须先获得数据库连接。该接口的常用方法如下：</p>
<ul>
<li>Statement createStatement（） throws SQLExcetpion∶ 该方法返回一个 Statement 对象。 </li>
<li>PreparedStatement prepareStatement（String sql）throws SQLExcetpion∶ 该方法返回预编译的 Statement 对象，即将 SOL 语句提交到数据库进行预编译。 </li>
<li>CallableStatement prepareCall（String sql） throws SQLExcetpion∶ 该方法返回 CallableStatement 对象，该对象用于调用存储过程。</li>
</ul>
<p>  </p>
<p>上面三个方法都返回用于执行 SQL 语句的 Statement 对象，PreparedStatement、CallableStatement是 Statement 的子类，只有获得了 Statement 之后才可执行 SQL 语句。</p>
<p>除此之外，Connection 还有如下几个用于控制事务的方法。</p>
<ul>
<li>Savepoint setSavepoint（）∶创建一个保存点。</li>
<li>Savepoint setSavepoint（String name）∶ 以指定名字来创建一个保存点。</li>
<li>void setTransactionIsolation（int level）∶ 设置事务的隔离级别。</li>
<li>void rollback（）∶ 回滚事务。 &gt; void rollback（Savepoint savepoint）∶ 将事务回滚到指定的保存点。</li>
<li>void setAutoCommit（boolean autoCommit）∶关闭自动提交，打开事务。&gt; void commit（）∶提交事务。</li>
</ul>
<h3 id="Statement接口"><a href="#Statement接口" class="headerlink" title="Statement接口"></a>Statement接口</h3><p>Statement∶用于执行 SQL 语句的工具接口。该对象既可用于执行DDL、DCL 语句，也可用于 执行 DML 语句，还可用于执行 SQL 查询。当执行 SQL 查询时，返回查询到的结果集。它的常用方法如下。 </p>
<ul>
<li>ResultSet executeQuery（String sql）throws SQLException∶该方法用于执行查询语句，并返回查 询结果对应的 ResultSet 对象。该方法只能用于执行查询语句。 </li>
<li>int executeUpdate（String sql）throws SQLExcetion∶ 该方法用于执行 DML 语句，并返回受影响 的行数; 该方法也可用于执行 DDL 语句，执行 DDL 语句将返回 0。 </li>
<li>boolean execute（String sql）throws SOLException∶ 该方法可执行任何 SOL 语句。如果执行后 第一个结果为 ResultSet 对象，则返回 true; 如果执行后第一个结果为受影响的行数或没有任何结果，则返回 false。</li>
</ul>
<p>PreparedStatement：预编译的 Statement 对象。PreparedStatement 是 Statement 的子接口，它允 许数据库预编译 SOL 语句（这些 SOL 语句通常带有参数），以后每次只改变 SOL 命令的参数，避免数据库每次都需要编译 SQL 语句，因此性能更好。相对于 Statement 而言，使用 PreparedStatement 执行 SOL 语句时，无须再传入 SOL 语句，只要为预编译的 SOL 语句传入参数值即可。所以它比 Statement 多了如下方法。 </p>
<ul>
<li>void setXxx（int parameterlndex，Xxx value）∶该方法根据传入参数值的类型不同，需要使用不 同的方法。传入的值根据索引传给 SQL 语句中指定位置的参数。</li>
</ul>
<h3 id="ResultSet接口"><a href="#ResultSet接口" class="headerlink" title="ResultSet接口"></a>ResultSet接口</h3><p>ResultSet：结果集对象。该对象包含访问查询结果的方法，ResultSet 可以通过列索引或列名获 得列数据。它包含了如下常用方法来移动记录指针。</p>
<ul>
<li>void close()：释放 ResultSet 对象。 </li>
<li>boolean absolute(int row)：将结果集的记录指针移动到第 row 行，如果 row 是负数，则移动 到倒数第 row 行。如果移动后的记录指针指向一条有效记录，则该方法返回 true。 </li>
<li>void beforeFirst()：将 ResultSet 的记录指针定位到首行之前，这是 ResultSet 结果集记录指针 的初始状态——记录指针的起始位置位于第一行之前。 </li>
<li>boolean first()：将 ResultSet 的记录指针定位到首行。如果移动后的记录指针指向一条有效记 录，则该方法返回 true。 </li>
<li>boolean previous()：将 ResultSet 的记录指针定位到上一行。如果移动后的记录指针指向一条 有效记录，则该方法返回 true。 </li>
<li>boolean next()：将 ResultSet 的记录指针定位到下一行，如果移动后的记录指针指向一条有效 记录，则该方法返回 true。 </li>
<li>boolean last()：将 ResultSet 的记录指针定位到最后一行，如果移动后的记录指针指向一条有 效记录，则该方法返回 true。 ·</li>
<li>void afterLast()： 将 ResultSet 的记录指针定位到最后一行之后。</li>
</ul>
<p> </p>
<p>当把记录指针移动到指定行之后，ResultSet 可通过 getXxx（int columnIndex）或 getXxx（String columnLabel）方法来获取当前行、指定列的值，前者根据列索引获取值，后者根据列名获取值。Java 7新增了<T>T getObject（int columnIndex，Class<T> type）和<T>T getObject（String columnLabel， Class<T> type）两个泛型方法，它们可以获取任意类型的值。 </p>
<h2 id="JDBC编程步骤"><a href="#JDBC编程步骤" class="headerlink" title="JDBC编程步骤"></a>JDBC编程步骤</h2><p>大致了解了JDBC API的相关接口和类之后，下面就可以进行 JDBC 编程了，JDBC编程大致按如下步骤进行。</p>
<ol>
<li>加载驱动</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//加载MySQL驱动</span></span><br><span class="line">Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line"><span class="comment">//如果要加载Oracle驱动</span></span><br><span class="line">Class.forName(<span class="string">&quot;Oracle.jdbc.driver.OracleDriver&quot;</span>);</span><br></pre></td></tr></table></figure>

<ol>
<li>获取连接</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取连接</span></span><br><span class="line">DriverManager.getConnection(String url,String user,String pass);</span><br></pre></td></tr></table></figure>

<p>当使用 DriverManager 获取数据库连接时，通常需要传入三个参数;数据库 URL、登录数据库的用户名和密码。这三个参数中用户名和密码通常由 DBA（数据库管理员）分配，而且该用户还应该具有相应的权限，才可以执行相应的 SQL 语句。 数据库 URL通常遵循如下写法∶</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbc:subprotoclo:othre stuff</span><br></pre></td></tr></table></figure>

<p>上面 URL 写法中的 jdbc 是固定的，而 subprotocol 指定连接到特定数据库的驱动，而后面的 other和 stuff也是不固定的——也没有较强的规律，不同数据库的 URL 写法可能存在较大差异。例如，MySQL数据库的 URL写法如下∶ </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbc:mysql:<span class="comment">//hostname:port/databasename</span></span><br></pre></td></tr></table></figure>

<p>在上面的链接中hostname指的是数据库所在主机的IP或者域名，如果要连接本机则可以写作“localhost”或者“127.0.0.1”，port则是指数据库的端口号，MySQL的端口号默认是3306，database则是只要连接数据库的名称。</p>
<p>Oracle数据库的URL写法如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbc:oracle:thin:<span class="meta">@hostname</span>:port:databasename</span><br></pre></td></tr></table></figure>

<ol>
<li>通过Connection获取Statement对象</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatemen();</span><br></pre></td></tr></table></figure>

<ol>
<li>使用Statement对象执行SQL语句</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;INSERT INTO STUDENT VALUES(1,&#x27;张三&#x27;,18,&#x27;男&#x27;)&quot;</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> statement.executeUpdate(sql);</span><br></pre></td></tr></table></figure>

<ol>
<li>获取结果，此处使用的是Statement对象的executeUpdate方法，该方法返回的是影响的行数，如果要调用executeQuery方法，则返回值是一个ResultSet对象。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> statement.executeQuery(sql);</span><br><span class="line"><span class="keyword">while</span>(rs.next()) &#123;</span><br><span class="line">	System.out.println(rs.getInt(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">	System.out.println(rs.getString(<span class="string">&quot;student_name&quot;</span>));</span><br><span class="line">	System.out.println(rs.getInt(<span class="string">&quot;student_age&quot;</span>));</span><br><span class="line">	System.out.println(rs.getInt(<span class="string">&quot;gender&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>释放资源</li>
</ol>
<p>下面，将上述步骤进行整合，示范JDBC编程步骤：</p>
<p>首先创建数据库和数据表：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">--创建数据库</span><br><span class="line">CREATE DATABASE TEST_DB;</span><br><span class="line">--切换数据库</span><br><span class="line">USE TEST_DB;</span><br><span class="line">--创建表</span><br><span class="line">CREATE TABLE <span class="title function_">STUDENT</span><span class="params">(</span></span><br><span class="line"><span class="params">  ID INT(<span class="number">11</span>)</span>,</span><br><span class="line">  STUDENT_NAME <span class="title function_">VARCHAR</span><span class="params">(<span class="number">25</span>)</span>,</span><br><span class="line">  STUDENT_AGE <span class="title function_">VARCHAR</span><span class="params">(<span class="number">11</span>)</span>,</span><br><span class="line">  STUDENT_GENDER <span class="title function_">CHAR</span><span class="params">(<span class="number">2</span>)</span></span><br><span class="line">);</span><br><span class="line">--插入数据</span><br><span class="line">INSERT INTO STUDENT <span class="title function_">VALUES</span> <span class="params">(<span class="number">1</span>,<span class="string">&quot;张三&quot;</span>,<span class="number">18</span>,<span class="string">&#x27;男&#x27;</span>)</span>;</span><br><span class="line">INSERT INTO STUDENT <span class="title function_">VALUES</span> <span class="params">(<span class="number">2</span>,<span class="string">&quot;李四&quot;</span>,<span class="number">18</span>,<span class="string">&#x27;男&#x27;</span>)</span>;</span><br><span class="line"><span class="keyword">package</span> cn.bytecollege;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDBCDemo</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		<span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/test_db?serverTimezone=Asia/Shanghai&quot;</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">		<span class="comment">//1.加载驱动</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">			System.out.println(<span class="string">&quot;驱动未加载&quot;</span>);</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//2.获取连接</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">		<span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">			<span class="comment">//3.获取Statement</span></span><br><span class="line">			statement = connection.createStatement();</span><br><span class="line">			<span class="comment">//4.执行SQL语句</span></span><br><span class="line"><span class="comment">//			String sql = &quot;INSERT INTO STUDENT (1,&#x27;张三&#x27;,18,&#x27;男&#x27;)&quot;;</span></span><br><span class="line"><span class="comment">//			int k = statement.executeUpdate(sql);</span></span><br><span class="line">			<span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM STUDENT&quot;</span>;</span><br><span class="line">			<span class="comment">//5.获取结果</span></span><br><span class="line">			<span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> statement.executeQuery(sql);</span><br><span class="line">			<span class="keyword">while</span>(rs.next()) &#123;</span><br><span class="line">				System.out.print(rs.getInt(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">				System.out.print(rs.getString(<span class="string">&quot;student_name&quot;</span>));</span><br><span class="line">				System.out.print(rs.getInt(<span class="string">&quot;student_age&quot;</span>));</span><br><span class="line">				System.out.print(rs.getString(<span class="string">&quot;gender&quot;</span>));</span><br><span class="line">				System.out.println();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				statement.close();</span><br><span class="line">				connection.close();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">				<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行上面的程序，结果如下图：</p>
<p><img src="https://files.catbox.moe/lv8m1j.png"></p>
<h2 id="使用PrepareStatement执行SQL语句"><a href="#使用PrepareStatement执行SQL语句" class="headerlink" title="使用PrepareStatement执行SQL语句"></a>使用PrepareStatement执行SQL语句</h2><p>如果经常需要反复执行一条结构相似的 SQL 语句，例如如下两条 SQL 语句∶ </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO STUDENT <span class="title function_">VALUES</span> <span class="params">(<span class="number">1</span>,<span class="string">&quot;张三&quot;</span>,<span class="number">18</span>,<span class="string">&#x27;男&#x27;</span>)</span>;</span><br><span class="line">INSERT INTO STUDENT <span class="title function_">VALUES</span> <span class="params">(<span class="number">2</span>,<span class="string">&quot;李四&quot;</span>,<span class="number">18</span>,<span class="string">&#x27;男&#x27;</span>)</span>;</span><br></pre></td></tr></table></figure>

<p>对于这两条 SOL 语句而言，它们的结构基本相似，只是执行插入时插入的值不同而已。对于这种情况，可以使用带占位符（?）参数的 SOL语句来代替它; </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO STUDENT <span class="title function_">VALUES</span> <span class="params">(?,?,?,?)</span>;</span><br></pre></td></tr></table></figure>

<p>但 Statement 执行 SOL 语句时不允许使用问号占位符参数，而且这个问号占位符参数必须获得值后才可以执行。为了满足这种功能，JDBC提供了PreparedStatement接口，它是 Statement接口的子接口，它可以预编译 SQL 语句，预编译后的 SQL 语句被存储在 PreparedStatement 对象中，然后可以使用该对象多次高效地执行该语句。简而言之，使用 PreparedStatement 比使用 Statement 的效率要高。 创建 PreparedStatement 对象使用 Connection 的 prepareStatement()方法，该方法需要传入一个 SQL字符串，该 SQL 字符串可以包含占位符参数。如下代码所示∶ </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;INSERT INTO STUDENT (?,?,?,?)&quot;</span>;</span><br><span class="line"><span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br></pre></td></tr></table></figure>

<p>PreparedStatement 也提供了execute()、executeUpdate()、executeQuery()三个方法来执行 SQL 语句，不过这三个方法无须参数，因为 PreparedStatement 已存储了预编译的 SOL 语句。 使用 PreparedStatement 预编译 SOL 语句时，该 SOL 语句可以带占位符参数，因此在执行 SOL 语句之前必须为这些参数传入参数值，PreparedStatement 提供了一系列的 setXxx（int index，Xxx value）方法来传入参数值。</p>
<p>下面通过示例学习PrepareStatement的用法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bytecollege;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDBCDemo2</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		<span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/test_db?serverTimezone=Asia/Shanghai&quot;</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">		<span class="comment">//1.加载驱动</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">			System.out.println(<span class="string">&quot;驱动未加载&quot;</span>);</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//2.获取连接</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">		<span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">			<span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;INSERT INTO STUDENT VALUES (?,?,?,?)&quot;</span>;</span><br><span class="line">			ps = connection.prepareStatement(sql);</span><br><span class="line">			ps.setInt(<span class="number">1</span>, <span class="number">3</span>);</span><br><span class="line">			ps.setString(<span class="number">2</span>, <span class="string">&quot;王五&quot;</span>);</span><br><span class="line">			ps.setInt(<span class="number">3</span>, <span class="number">20</span>);</span><br><span class="line">			ps.setString(<span class="number">4</span>, <span class="string">&quot;女&quot;</span>);</span><br><span class="line">			<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> ps.executeUpdate();</span><br><span class="line">			System.out.println(k);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				ps.close();</span><br><span class="line">				connection.close();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">				<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>需要注意的是使用PrepareStatement的setXxx()方法时，第一个参数是占位符的索引，第二个参数是占位符的真实值，占位符的索引是从1开始。</p>
<p>总体来看，使用 PreparedStatement 比使用 Statement 多了如下三个好处。</p>
<ol>
<li>PreparedStatement 预编译 SQL 语句，性能更好。</li>
<li>PreparedStatement 无须拼接SQL 语句，编程更简单。</li>
<li>PreparedStatement 可以防止 SQL 注入，安全性更好。</li>
</ol>
<p> 基于以上三点，通常推荐避免使用 Statement 来执行 SQL 语句，改为使用 PreparedStatement 执行 SQL语句。</p>
<h2 id="可滚动的结果集"><a href="#可滚动的结果集" class="headerlink" title="可滚动的结果集"></a>可滚动的结果集</h2><p>前面提到，ResultSet 定位记录指针的方法有 absolute（O）、previous（等方法，但前面程序自始至终都只用了 next（）方法来移动记录指针，实际上也可以使用 absoluteO、previousO、lastO）等方法来移动记录 指针。可以使用 absolute（）、previous（、afterLast（）等方法自由移动记录指针的 ResultSet 被称为可滚动的结果集。  </p>
<p>在 JDK 1.4 以前，默认打开的 ResultSet 是不可滚动的，必须在创建 Statement 或 PreparedStatement 时传入额外的参数。从 Java 5.0 以后，默认打开的 ResultSet 就是可滚动的，无须传入额外的参数。 </p>
<p>以默认方式打开的 ResultSet 是不可更新的，如果希望创建可更新的 ResultSet，则必须在创建 Statement 或 PreparedStatement 时传入额外的参数。Connection 在创建 Statement 或 PreparedStatement 时还可额外传入如下两个参数。 </p>
<ol>
<li>resultSetType∶ 控制 ResultSet 的类型，该参数可以取如下三个值：</li>
</ol>
<ul>
<li><ul>
<li> ResultSet.TYPE FORWARD ONLY∶该常量控制记录指针只能向前移动。这是 JDK1.4 以前 的默认值。 </li>
<li>ResultSet.TYPE SCROLL INSENSITIVE∶该常量控制记录指针可以自由移动（可滚动结果 集），但底层数据的改变不会影响 ResultSet 的内容。 </li>
<li>ResultSet.TYPE SCROLL SENSITIVE∶该常量控制记录指针可以自由移动（可滚动结果集）， 而且底层数据的改变会影响 ResultSet 的内容。</li>
</ul>
</li>
</ul>
<p> </p>
<ol>
<li>resultSetConcurrency∶控制 ResultSet 的并发类型，该参数可以接收如下两个值 ·：</li>
</ol>
<ul>
<li><ul>
<li>ResultSet.CONCUR_READ_ONLY∶该常量指示 ResultSet 是只读的并发模式（默认）。·</li>
<li>ResultSet.CONCUR UPDATABLE∶该常量指示 ResultSet是可更新的并发模式。</li>
</ul>
</li>
</ul>
<p>注意：TYPE SCROLL INSENSITIVE、TYPE SCROLL SENSITIVE 两个常量的作用需要底层数据库驱动的支持，对于有些数据库驱动来说，这两个常量并没有太大的区别。 </p>
<p>需要指出的是，可更新的结果集还需要满足如下两个条件。</p>
<ol>
<li>所有数据都应该来自一个表。</li>
<li>选出的数据集必须包含主键列。</li>
</ol>
<p> </p>
<p>通过该 PreparedStatement 创建的 ResultSet 就是可滚动、可更新的，程序可调用 ResultSet 的 updateXxx（int columnIndex，Xxx value）方法来修改记录指针所指记录、特定列的值，最后调用 ResultSet的 updateRow()方法来提交修改。</p>
<p>下面通过示例来学习可滚动的结果集。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bytecollege;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDBCDemo2</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		<span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/test_db?serverTimezone=Asia/Shanghai&quot;</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">		<span class="comment">//1.加载驱动</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">			System.out.println(<span class="string">&quot;驱动未加载&quot;</span>);</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//2.获取连接</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">		<span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">			<span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM STUDENT&quot;</span>;</span><br><span class="line">			ps = connection.prepareStatement(sql,ResultSet.TYPE_SCROLL_SENSITIVE,ResultSet.CONCUR_UPDATABLE);</span><br><span class="line">			<span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> ps.executeQuery();</span><br><span class="line">			<span class="comment">//将游标定位到最后一行</span></span><br><span class="line">			rs.last();</span><br><span class="line">			<span class="comment">//获取总行数</span></span><br><span class="line">			<span class="type">int</span> <span class="variable">row</span> <span class="operator">=</span> rs.getRow();</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> row; i &gt;<span class="number">0</span>; i--) &#123;</span><br><span class="line">				<span class="comment">//定位读取的行数</span></span><br><span class="line">				rs.absolute(i);</span><br><span class="line">				System.out.print(rs.getInt(<span class="string">&quot;id&quot;</span>)+<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">				System.out.print(rs.getString(<span class="string">&quot;student_name&quot;</span>)+<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">				System.out.print(rs.getInt(<span class="string">&quot;student_age&quot;</span>)+<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">				System.out.print(rs.getString(<span class="string">&quot;gender&quot;</span>)+<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">				System.out.println();</span><br><span class="line">				<span class="comment">//更新第二列，即学生姓名</span></span><br><span class="line">				rs.updateString(<span class="number">2</span>, <span class="string">&quot;姓名&quot;</span>+i);</span><br><span class="line">				rs.updateRow();</span><br><span class="line">				System.out.println();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				ps.close();</span><br><span class="line">				connection.close();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">				<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行上面的程序结果如下图：</p>
<p><img src="https://files.catbox.moe/tqdw0i.png"></p>
<p>从运算结果可以看出输入数据时是倒序输出的，这是因为在程序中先将游标定位到了最后一行，然后倒序循环，通过absolute()定位到每一行数据并读取。读取完数据后，将数据表中的第2列数据进行了修改，此时查询数据库如下图：</p>
<p><img src="https://files.catbox.moe/bb73ur.png"></p>
<h2 id="使用ResultSetMetaData分析结果集"><a href="#使用ResultSetMetaData分析结果集" class="headerlink" title="使用ResultSetMetaData分析结果集"></a>使用ResultSetMetaData分析结果集</h2><p>当执行 SOL 查询后可以通过移动记录指针来遍历 ResultSet 的每条记录，但程序可能不清楚该 ResultSet 里包含哪些数据列，以及每个数据列的数据类型，那么可以通过 ResultSetMetaData 来获取关于 ResultSet 的描述信息。</p>
<p>ResultSet 里包含一个 getMetaData()方法，该方法返回该 ResultSet 对应的 ResultSetMetaData 对象。一旦获得了 ResultSetMetaData 对象，就可通过 ResultSetMetaData 提供的大量方法来返回 ResultSet 的描述信息。常用的方法有如下三个。 </p>
<ul>
<li>int getColumnCount()∶ 返回该 ResultSet 的列数量。</li>
<li>String getColumnName(int column)∶返回指定索引的列名。</li>
<li>String getColumnClassName（int column）∶返回指定索引的列类型。</li>
</ul>
<p> </p>
<p>下面通过示例来学习ResultSetMetaData的用法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bytecollege;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSetMetaData;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ResultSetMetaDataDemo</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		<span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/test_db?serverTimezone=Asia/Shanghai&quot;</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">		<span class="comment">//1.加载驱动</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">			System.out.println(<span class="string">&quot;驱动未加载&quot;</span>);</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//2.获取连接</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">		<span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">			<span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM STUDENT&quot;</span>;</span><br><span class="line">			ps = connection.prepareStatement(sql);</span><br><span class="line">			<span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> ps.executeQuery();</span><br><span class="line">			<span class="comment">//获取结果集元数据</span></span><br><span class="line">			<span class="type">ResultSetMetaData</span> <span class="variable">metaData</span> <span class="operator">=</span> rs.getMetaData();</span><br><span class="line">			<span class="comment">//获取结果集列数</span></span><br><span class="line">			<span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> metaData.getColumnCount();</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= count; i++) &#123;</span><br><span class="line">				<span class="comment">//获取每列的字段名</span></span><br><span class="line">				System.out.print(metaData.getColumnName(i)+<span class="string">&quot;\t\t&quot;</span>);</span><br><span class="line">				<span class="comment">//获取每列的数据类型</span></span><br><span class="line">				System.out.print(metaData.getColumnTypeName(i)+<span class="string">&quot;\t\t&quot;</span>);</span><br><span class="line">				<span class="comment">//获取每列对应的Java数据类型</span></span><br><span class="line">				System.out.print(metaData.getColumnClassName(i)+<span class="string">&quot;\t\t&quot;</span>);</span><br><span class="line">				System.out.println();</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				ps.close();</span><br><span class="line">				connection.close();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">				<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行上面的程序，结果如下</p>
<p><img src="https://files.catbox.moe/j2v6oe.png"></p>

    </div>

    
    
    
      


    <footer class="post-footer">
          <div class="reward-container">
  <div></div>
  <button>
    赞赏
  </button>
  <div class="post-reward">

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>Fei
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://airui520.github.io/2022/09/08/JDBC%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93/" title="JDBC连接数据库">https://airui520.github.io/2022/09/08/JDBC连接数据库/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/09/08/MySQL%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE/" rel="prev" title="MySQL查询数据">
                  <i class="fa fa-chevron-left"></i> MySQL查询数据
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/09/09/MySQL%E5%87%BD%E6%95%B0/" rel="next" title="MySQL函数">
                  MySQL函数 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2001 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Fei</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">1.2m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">18:31</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>
  <div class="addthis_inline_share_toolbox">
    <script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=your_add_this_id" async="async"></script>
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.0/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>
<script class="next-config" data-name="chatra" type="application/json">{"enable":true,"async":true,"id":null}</script>
<script src="/js/third-party/chat/chatra.js"></script>
<script async src="https://call.chatra.io/chatra.js"></script>





  





</body>
</html>
